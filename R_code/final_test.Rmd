---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
test_multitree_data = read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/ML/test_multi_tree_data.tsv")

multitree_data = read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/ML/overall_performance_on_test_set.tsv") 

validation_multi_tree = read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/ML/validation_multi_tree_data.tsv")


default_performance = read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/ML/default_sampling.tsv")
```

```{r}
multitree_data %>% distinct (msa_path) %>% arrange(msa_path)
```
```{r}
data<-multitree_data %>% filter (metric=='predicted_total_accuracy_calibrated_isotonic') %>% filter (threshold>=0.9) %>% distinct (msa_path, total_actual_time, total_time_predicted, status) %>% mutate(time_saved = 20/total_actual_time)
data%>% ggplot(aes(x=time_saved))+geom_histogram()
summary(data %>% pull (time_saved))
```


```{r}

mean_default_performance<-default_performance %>% group_by(msa_path) %>% summarise(default_status = mean(default_status))


joint_data<-test_multitree_data %>% group_by(msa_path) %>% summarise(maxi = max(status)) %>% filter (maxi==0) %>% inner_join(mean_default_performance, by = "msa_path") 
joint_data %>% arrange(-default_status)
#mean(joint_data %>% pull (default_status))



joint_data<-test_multitree_data %>% group_by(msa_path) %>% summarise(maxi = max(status)) %>% filter (maxi==1) %>% inner_join(mean_default_performance, by = "msa_path") 
joint_data %>% arrange(default_status)
#mean(joint_data %>% pull (default_status))


mean(mean_default_performance %>% pull (default_status)) 

mean(test_multitree_data %>% filter (n_trees_used==40) %>% pull (status)) 
```


```{r}

#mean_default_performance %>% distinct (msa_path) %>% arrange(msa_path)

multitree_data %>% distinct (msa_path) %>% arrange(msa_path)

validation_multi_tree %>% distinct (msa_path) %>% arrange(msa_path)


test_multitree_data %>% distinct (msa_path) %>% arrange(msa_path)

```

```{r}

```



Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

