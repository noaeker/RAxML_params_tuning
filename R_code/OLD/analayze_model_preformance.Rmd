---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(tidyverse)
library(survival)
library(survminer)
library(cmprsk)
library(tidyverse)
library(caret)
library(survival)
library(survminer)
library(lubridate)
```


```{r}
model_performance = read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/final_performance_comp.tsv")
model_performance<- model_performance %>% mutate (time_imprv = 20/total_actual_time, accuracy_diff =diff-mean_default_diff )
```


```{r}
library(lme4)
library(lmerTest)

mixed1 = lmer(d ~(is_polyploid)+(1|network)+(1|original_name), data =all_binary_species_level_no_null)
print(summary(mixed1))

model_performance %>% arrange(-diff)
```






Efficiency

```{r}
model_performance %>% ggplot(aes(x=time_imprv)) + geom_histogram(color="darkblue", fill="lightblue")+
  labs(title="Running-time improvement between default cofnfiguration to ML-based tree search",x="Running-time improvement", y = "Count")+theme(axis.text=element_text(size=14),axis.title=element_text(size=14,face="bold"))
summary(model_performance %>% pull(time_imprv))
```




```{r}
model_performance %>% select (total_time_predicted, total_actual_time) %>% ggplot(aes(x=total_time_predicted, y = total_actual_time))+geom_point()
```


Accuracy

```{r}
model_performance %>% ggplot(aes(x=accuracy_diff)) + geom_histogram(color="darkblue", fill="pink")+
  labs(title="Log-likelihood difference between default cofnfiguration to ML-based tree search",x="Log-likelihood diff", y = "Count")+theme(axis.text=element_text(size=14),axis.title=element_text(size=14,face="bold"))

summary(model_performance  %>% pull(diff))

summary(model_performance %>% pull(mean_default_diff))


```
```{r}
model_performance %>% filter (status==0) %>% arrange(-diff)
```



```{r}
performance_on_test_set<- read_tsv("/Users/noa/Workspace/raxml_deep_learning_results/ready_raw_data/Pandit/test_methodology_performance.tsv") 


performance_on_test_set %>% filter (msa_path=='/groups/pupko/noaeker/data/New_MSAs/Pandit_msas/PF01709.fasta') %>% select (sum_of_predicted_success_probability, n_parsimony_trees_used, n_random_trees_used, diff, n_parsimony_clusters) %>% arrange(diff )
```


```{r}
performance_on_test_set %>% ggplot(aes(x=sum_of_predicted_success_probability, y=diff))+geom_point()
```





Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
```{r}
summary(train)
```

